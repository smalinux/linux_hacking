# 

### Build the documentation
You donâ€™t need to depend on GitHub.

For a quick and dirty build, install Asciidoctor however you like and build:
....
asciidoctor README.adoc
xdg-open README.html
....

How to watch dmesg live ?!

run this script: `sudo sh printk_live.sh`

### link:../main/defer_printk.c[Why printk is not showing the latest output?] module
Sometimes `printk` may defer output (that is, message is stored in the internal buffer, but not in kernel log). To avoid such behavior, always add newline (`\n`) at the end of the string printed:
....
printk(KERN_ALERT "%s*\n*" ,mystring);
....
link:https://stackoverflow.com/a/47593056/5688267[Reference].

### link:../main/core_api.c[Core APIs] module
A simple practical uses of : `Documentation/core-api/kernel-api.rst`.

### Kallsyms
what is kallsyms? Google: "kallsyms man", but man page will not enough.
link:Xhttps://onebitbug.me/2011/03/04/introducing-linux-kernel-symbols/[this] will be enough! ))

link:https://stackoverflow.com/a/28938043/5688267[`System.map` file vs `/proc/kallsyms`]?

*This is for educational perposes*, most of kallsyms unexported of link:https://lwn.net/Articles/813350/[Linux 5.7] for security reasons.

"Functions and variables which are exported through EXPORT_SYMBOL is for kernel module code.
It makes a symbol accessible to dynamically loaded modules (provided that said modules add an extern declaration)."

link:https://stackoverflow.com/a/37979809/5688267[How] to dump all kallsyms symbols? code. *TODO*.

How to access address of any Linux symbol? link:https://www.google.com/search?q=access+function+kallsyms[Google].
You really NEED to understand what is the meaning of EXPORT_SYMBOL,
What is the difference between extern and EXPORT_SYMBOL -> Google,
link:https://stackoverflow.com/a/57881867/5688267[quora].

Google: `The Kernel Symbol Table`, `EXPORT_SYMBOL`, `System.map`, `/proc/kallsyms`, `"EXPORT_SYMBOL lwn.net"`

#### Technic link:https://lists.kernelnewbies.org/pipermail/kernelnewbies/2014-January/009617.html[#1]
http://stackoverflow.com/questions/11463184/how-to-use-exported-symbols-in-the-linux-kernel
http://stackoverflow.com/questions/1196944/can-i-replace-a-linux-kernel-function-with-a-module

#### man nm
This simple program will help you by listing all symbols to dump your memory.
`man nm` has a meaning of every abbr.

How to use it?
....
nm file.o
nm mm.ko
....

Output sample:
....
0000000000000041 T cleanup_module
                 U __fentry__
                 U find_get_pid
0000000000000041 t hello_exit
0000000000000000 t hello_init
0000000000000000 T init_module
0000000000000000 V i_weak
0000000000000000 r _note_7
0000000000000008 B p
                 U printk
0000000000000048 B smalinux_i
0000000000000000 D smalinux_ii
0000000000000020 B smalinux_iii
0000000000000080 B smalinux_ts
0000000000000000 T sum
0000000000000000 D __this_module
....


### link:../main/string.c[String] manipulation module
`Documentation/core-api/kernel-api.rst`

How to use it:
....
insmod string.ko
....

### link:https://github.com/cirosantilli/linux-kernel-module-cheat#gdb[GDB with linux]
Google: gdb kernel.
to understand the theary.


### link:https://github.com/smalinux/linux-kernel-module-cheat#kgdb[KGDB with linux]
(link:https://youtu.be/PyKqQ05w_UY[See my demo])

Very nice and basic link:https://www.youtube.com/watch?v=67cxIXLCfUk[video] tutorial show you the basic idea behind kgdb.
Thankfully, YouTube has all of tutorials you can hack this topic with them. 

link:https://unix.stackexchange.com/a/364966/265591[Serial port]

References:

* https://github.com/smalinux/linux-kernel-module-cheat#kgdb
* `Documentation/dev-tools/kgdb.rst`
* https://youtu.be/HBOwoSyRmys




### Oops
Decoding an oops:

* CONFIG_DEBUG_INFO
* addr2line (man it!)
* gdb
* objdump
* objdump -dSr

References:

* `Documentation/admin-guide/bug-hunting.rst`
* https://linux-kernel-labs.github.io/refs/heads/master/lectures/debugging.html

#### stack trace ?!
link:https://stackoverflow.com/a/13468456/5688267[__1__],
link:https://github.com/cirosantilli/linux-kernel-module-cheat/tree/b8f190cc24b4f7474894b68a5510a8f3d767843d#kernel-panic-and-oops[__2__],
link:https://developer.squareup.com/blog/a-short-guide-to-kernel-debugging/[__3__],
link:https://embeddedbits.org/tracing-the-linux-kernel-with-ftrace/[__4__],
link:https://stackoverflow.com/a/16742918/5688267[__5__],
link:https://www.kernel.org/doc/html/latest/trace/ftrace.html[__6__],
link:https://d3s.mff.cuni.cz/files/teaching/nswi161/slides/06_debugging.pdf[__7__],
link:https://serverfault.com/questions/605946/kernel-stack-trace-to-source-code-lines[__8__],


#### Memory debugging
There are several tools for memory debugging:

....
SLAB/SLUB debugging
KASAN
kmemcheck
DEBUG_PAGEALLOC
....

#### Lockdep checker

#### perf

#### Other tools

....
ftrace
kprobes
sparse
coccinelle
checkpatch.pl
printk
dump_stack() 
....


#### Read Later:

??? https://www.dedoimedo.com/computers/crash-analyze.html


< API >>> https://kernelnewbies.org/ABI
....
Documentation/admin-guide/bug-hunting.rst
Documentation/admin-guide/kdump/kdump.rst
Documentation/dev-tools/gdb-kernel-debugging.rst
Documentation/dev-tools/kgdb.rst
Documentation/trace/kprobes.rst
....







Read link:../main/TODO.adoc[TODO] later.
